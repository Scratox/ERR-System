"use strict";var express=require("express"),passport=require("passport"),LocalStrategy=require("passport-local").Strategy,session=require("express-session"),app=express();app.use(express.urlencoded({extended:!0})),app.use(session({secret:"your-secret-key",resave:!1,saveUninitialized:!1})),app.use(passport.initialize()),app.use(passport.session());var users=[{id:1,username:"teacher",password:"teacherpassword",role:"teacher"},{id:2,username:"student",password:"studentpassword",role:"student"}];function isAuthenticated(r){return function(e,s,t){if(e.isAuthenticated()&&e.user.role===r)return t();s.redirect("/")}}passport.serializeUser(function(e,s){s(null,e.id)}),passport.deserializeUser(function(s,e){e(null,users.find(function(e){return e.id===s}))}),passport.use(new LocalStrategy(function(s,t,e){var r=users.find(function(e){return e.username===s&&e.password===t});return r?e(null,r):e(null,!1,{message:"Incorrect username or password."})})),app.get("/login",function(e,s){s.sendFile(__dirname+"/login.html")}),app.post("/login",passport.authenticate("local",{failureRedirect:"/login"}),function(e,s){"teacher"===e.user.role?s.redirect("/teacher"):"student"===e.user.role&&s.redirect("/student")}),app.get("/teacher",isAuthenticated("teacher"),function(e,s){s.send("Welcome, Teacher!")}),app.get("/student",isAuthenticated("student"),function(e,s){s.send("Welcome, Student!")}),app.get("/logout",function(e,s){e.logout(),s.redirect("/")});var PORT=process.env.PORT||3e3;app.listen(PORT,function(){console.log("Server is running on http://localhost:".concat(PORT))});
//# sourceMappingURL=app.min.js.map
