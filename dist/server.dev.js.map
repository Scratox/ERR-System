{"version":3,"sources":["server.js"],"names":["express","require","bodyParser","db","mysql","app","PORT","process","env","use","set","json","urlencoded","extended","pool","createPool","host","user","password","database","waitForConnections","connectionLimit","queueLimit","getDepartmentsRadio","req","res","next","sql","query","err","results","console","error","status","send","radioButtons","map","department","DepartmentName","locals","join","getModulesDropdown","dropdownOptions","module","ModuleName","getTeachersDropdown","teacher","TeacherName","authenticateUser","username","callback","length","log","post","body","authenticatedUser","UserRole","redirect","get","data","render","description","submissionDate","Date","toISOString","values","nonNullValues","filter","value","undefined","result","StudentID","TeacherID","FeedbackText","FeedbackDate","ExamID","studentID","params","feedbackData","listen"],"mappings":"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","sourcesContent":["const express = require('express');\r\nconst bodyParser = require('body-parser');\r\nconst db = require('./db');\r\nconst mysql = require('mysql2');\r\n\r\nconst app = express();\r\nconst PORT = process.env.PORT || 8888;\r\n\r\napp.use(express.static('public'));\r\napp.set('view engine', 'pug');\r\napp.use(bodyParser.json());\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\nconst pool = mysql.createPool({\r\n  host: '127.0.0.1',\r\n  user: 'root',\r\n  password: '',\r\n  database: 'examination_rectifier',\r\n  waitForConnections: true,\r\n  connectionLimit: 10,\r\n  queueLimit: 0\r\n});\r\n\r\n// Middleware to get departments radio buttons\r\nconst getDepartmentsRadio = (req, res, next) => {\r\n  const sql = 'SELECT DepartmentName FROM department';\r\n\r\n  db.query(sql, (err, results) => {\r\n    if (err) {\r\n      console.error('Error fetching departments:', err);\r\n      return res.status(500).send('Internal Server Error');\r\n    }\r\n\r\n    const radioButtons = results.map((department) => `\r\n      <input type=\"radio\" name=\"department\" value=\"${department.DepartmentName}\">\r\n      <label>${department.DepartmentName}</label>\r\n    `);\r\n\r\n    res.locals.getDepartmentsRadio = radioButtons.join('');\r\n    next();\r\n  });\r\n};\r\n\r\n// Middleware to get modules dropdown\r\nconst getModulesDropdown = (req, res, next) => {\r\n  const sql = 'SELECT ModuleName FROM modules';\r\n\r\n  db.query(sql, (err, results) => {\r\n    if (err) {\r\n      console.error('Error fetching modules:', err);\r\n      return res.status(500).send('Internal Server Error');\r\n    }\r\n\r\n    const dropdownOptions = results.map((module) => `\r\n      <option value=\"${module.ModuleName}\">${module.ModuleName}</option>\r\n    `);\r\n\r\n    res.locals.getModulesDropdown = `<select name=\"modules\">${dropdownOptions.join('')}</select>`;\r\n    next();\r\n  });\r\n};\r\n\r\n// Middleware to get teachers dropdown\r\nconst getTeachersDropdown = (req, res, next) => {\r\n  const sql = 'SELECT TeacherName FROM teachers';\r\n\r\n  db.query(sql, (err, results) => {\r\n    if (err) {\r\n      console.error('Error fetching teachers:', err);\r\n      return res.status(500).send('Internal Server Error');\r\n    }\r\n\r\n    const dropdownOptions = results.map((teacher) => `\r\n      <option value=\"${teacher.TeacherName}\">${teacher.TeacherName}</option>\r\n    `);\r\n\r\n    res.locals.getTeachersDropdown = `<select name=\"teachers\">${dropdownOptions.join('')}</select>`;\r\n    next();\r\n  });\r\n};\r\n\r\n// Authentication logic\r\nconst authenticateUser = (username, password, callback) => {\r\n  const sql = 'SELECT * FROM users WHERE Username = ? AND Password = ?';\r\n  db.query(sql, [username, password], (err, results) => {\r\n    if (err) {\r\n      console.error('Error during authentication:', err);\r\n      return callback(err, null);\r\n    }\r\n\r\n    if (results.length === 0) {\r\n      console.log('User not found during authentication for username:', username);\r\n      return callback(null, null);\r\n    }\r\n\r\n    const user = results[0];\r\n    console.log('User found during authentication:', user);\r\n    callback(null, user);\r\n  });\r\n};\r\n\r\n// Login route\r\napp.post('/login', (req, res) => {\r\n  const { username, password } = req.body;\r\n\r\n  authenticateUser(username, password, (err, authenticatedUser) => {\r\n    if (err) {\r\n      res.send('Error during authentication');\r\n    } else if (!authenticatedUser) {\r\n      res.send('Invalid credentials');\r\n    } else {\r\n      // Redirect based on user role\r\n      if (authenticatedUser.UserRole === 'Student') {\r\n        res.redirect('/student');\r\n      } else if (authenticatedUser.UserRole === 'Teacher') {\r\n        res.redirect('/teacher');\r\n      } else {\r\n        res.send('Invalid user role');\r\n      }\r\n    }\r\n  });\r\n});\r\n\r\n// Student dashboard\r\napp.get('/student', getDepartmentsRadio, getModulesDropdown, getTeachersDropdown, (req, res) => {\r\n  // Assuming you have middleware functions to provide data for departments, modules, and teachers\r\n  const data = {\r\n    getDepartmentsRadio: res.locals.getDepartmentsRadio,\r\n    getModulesDropdown: res.locals.getModulesDropdown,\r\n    getTeachersDropdown: res.locals.getTeachersDropdown,\r\n  };\r\n  res.render('student', data);\r\n});\r\n\r\n\r\n// Handle POST request to /submit-issue\r\napp.post('/submit-issue', (req, res) => {\r\n  const { description } = req.body;\r\n\r\n  // Assuming you have Status value available\r\n  const status = 'Pending'; // You can set the initial status as needed\r\n\r\n  // Get the current date and time for SubmissionDate\r\n  const submissionDate = new Date().toISOString();\r\n\r\n  // Insert data into problemsubmissions table with only non-null values\r\n  const sql = `\r\n    INSERT INTO problemsubmissions (ProblemDescription, SubmissionDate, Status)\r\n    VALUES (?, ?, ?)\r\n  `;\r\n\r\n  const values = [description, submissionDate, status];\r\n\r\n  // Filter out null or undefined values\r\n  const nonNullValues = values.filter(value => value !== null && value !== undefined);\r\n\r\n  db.query(sql, nonNullValues, (err, result) => {\r\n    if (err) {\r\n      console.error('Error inserting data into problemsubmissions table:', err);\r\n      res.status(500).send('Internal Server Error');\r\n    } else {\r\n      console.log('Data inserted successfully into problemsubmissions table');\r\n      res.send('Form submitted successfully');\r\n    }\r\n  });\r\n});\r\n\r\n// Teacher dashboard\r\napp.get('/teacher', (req, res) => {\r\n  db.query('SELECT * FROM problemsubmissions', (err, result) => {\r\n    if (err) {\r\n      console.error('Database query error:', err);\r\n      res.render('teacher', { result: null, error: 'Error during database query' });\r\n    } else {\r\n      res.render('teacher', { result });\r\n    }\r\n  });\r\n});\r\n\r\n// Index route\r\napp.get('/', (req, res) => {\r\n  res.render('index');\r\n});\r\n\r\n// Login route\r\napp.get('/login', (req, res) => {\r\n  res.render('login');\r\n});\r\n\r\napp.get('/submit-issue', (req, res) => {\r\n  res.render('student');\r\n});\r\n\r\napp.get('/feedback', (req, res) => {\r\n  res.render('feedback');\r\n});\r\napp.get('/submitted-feedback', (req, res) => {\r\n  res.render('submitted-feedback');\r\n});\r\n\r\napp.get('/home', (req, res) => {\r\n  res.render('home');\r\n});\r\n//for submitting feedback\r\napp.post('/feedback', (req, res) => {\r\n  const { StudentID, TeacherID, FeedbackText, FeedbackDate, ExamID } = req.body;\r\n\r\n  const sql = 'INSERT INTO feedback (StudentID, TeacherID, FeedbackText, FeedbackDate, ExamID) VALUES (?, ?, ?, ?, ?)';\r\n  const values = [StudentID, TeacherID, FeedbackText, FeedbackDate, ExamID];\r\n\r\n  pool.query(sql, values, (err, result) => {\r\n    if (err) {\r\n      console.error(err);\r\n      res.status(500).send('Internal Server Error');\r\n      return;\r\n    }\r\n\r\n    console.log('Feedback submitted successfully.');\r\n    res.redirect('/feedback');\r\n  });\r\n});\r\n\r\n//for viewing feedback\r\n\r\n// Route to view feedback for a specific student\r\napp.get('/submitted-feedback/:studentID', (req, res) => {\r\n  const studentID = req.params.studentID;\r\n\r\n  // Query to retrieve feedback based on StudentID\r\n  const sql = 'SELECT * FROM feedback WHERE StudentID = ?';\r\n  pool.query(sql, [studentID], (err, result) => {\r\n    if (err) {\r\n      console.error(err);\r\n      res.status(500).send('Internal Server Error');\r\n      return;\r\n    }\r\n\r\n    const feedbackData = result;\r\n\r\n    // Render the view-feedback page with the retrieved feedback data\r\n    res.render('submitted-feedback', { feedbackData });\r\n  });\r\n});\r\n\r\n\r\n\r\napp.listen(PORT, () => {\r\n  console.log(`Server is running on http://localhost:${PORT}`);\r\n});\r\n"],"file":"server.dev.js"}